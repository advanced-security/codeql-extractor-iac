name: "CodeQL IaC Extractor"
description: "CodeQL IaC Extractor GitHub Action"
author: "GitHub Security Lab"
branding:
  color: "blue"
  icon: "lock"

inputs:
  token:
    description: >
      The GitHub token used to make authenticated API requests.
    default: ${{ github.token }}
    required: false

outputs:
  sarif-results:
    description: >
      The path to the SARIF results file generated by the extractor.
    value: ${{ steps.extractor.outputs.sarif_results }}

runs:
  using: "composite"
  steps:
    - name: "CodeQL Extractor Action"
      uses: advanced-security/codeql-extractor-action@v0.1.0
      id: extractor
      with:
        token: ${{ inputs.token }}
        extractors: "advanced-security/codeql-extractor-iac@v0.5.0"
        packs: advanced-security/iac-queries
        languages: "iac"
